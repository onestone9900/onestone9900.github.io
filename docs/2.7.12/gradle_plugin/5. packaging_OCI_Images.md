---
layout: default
title: 5. Packaging OCI Images
parent: GradlePlugin
grand_parent: 2.7.12
nav_order: 5
---


# Chapter 5. Packaging OCI Images
플러그인은 [Cloud Native Buildpacks](https://buildpacks.io/)(CNB)를 사용하여 jar 또는 war 파일에서 [OCI 이미지](https://github.com/opencontainers/image-spec)를 생성할 수 있다. `bootBuildImage` 태스크를 사용하여 이미지를 빌드할 수 있다.

{: .important}
>보안상의 이유로 이미지는 루트가 아닌 사용자로 빌드 및 실행된다. 자세한 내용은 [CNB 사양](https://buildpacks.io/docs/reference/spec/platform-api/#users)을 참조해보자.

태스크는 `java` 또는 `war` 플러그인이 적용될 때 자동으로 생성되며 `BootBuildImage`의 인스턴스이다.


## 5.1. Docker Daemon
`bootBuildImage` 태스크에는 도커 데몬에 대한 액세스 권한이 필요하다. 기본적으로, 로컬 연결을 통해 도커 데몬과 통신한다. 이는 구성 없이 지원되는 모든 플랫폼에서 도커 엔진과 함께 작동한다. 

환경 변수를 설정하여 `bootBuildImage` 태스크를 대체 로컬(alternative local) 또는 원격 연결을 사용하도록 구성할 수 있다. 다음 표는 환경 변수와 해당 값을 보여준다:

|Environment variable|Description|
|-|-|
|DOCKER_HOST|도커 데몬의 호스트 및 포트를 포함하는 URL - 예를들어 `tcp://192.168.99.100:2376`|
|DOCKER_TLS_VERIFY|`1`로 설정된 경우 보안 HTTPS 프로토콜 활성화(선택 사항)|
|DOCKER_CERT_PATH|HTTPS용 인증서 및 키 파일의 경로(`DOCKER_TLS_VERIFY=1`인 경우 필수, 그렇지 않은 경우 무시됨)|

플러그인 구성에서 `도커` 프로퍼티를 사용하여 도커 데몬 연결 정보를 제공할 수도 있다. 다음 표에는 사용 가능한 프로퍼티가 요약되어 있다:

|Property|Description|
|-|-|
|`host`|도커 데몬의 호스트 및 포트를 포함하는 URL - 예를들어 `tcp://192.168.99.100:2376`|
|`tlsVerify`|`true`로 설정된 경우 보안 HTTPS 프로토콜 활성화(선택 사항)|
|`certPath`|HTTPS용 인증서 및 키 파일의 경로(`tlsVerify`가 `true`인 경우 필요, 그렇지 않은 경우 무시됨)|
|`bindHostToBuilder`|When true, the value of the host property will be provided to the container that is created for the CNB builder (optional)|

자세한 내용은 [예제](https://docs.spring.io/spring-boot/docs/2.7.12/gradle-plugin/reference/htmlsingle/#build-image.examples.docker)를 참조해보자.